---
combiner: OR
conditions:
- conditionThreshold:
    comparison: COMPARISON_GT
    duration: 300s
    filter: metric.type="custom.googleapis.com/opencensus/ts_bridge/oldest_metric_age"
      AND resource.type="global"
    aggregations:
    - alignmentPeriod: 60s
      perSeriesAligner: ALIGN_MAX
      crossSeriesReducer: REDUCE_MAX
      groupByFields: ["resource.label.project_id"]
    thresholdValue: 1800000.0
    trigger:
      count: 1
  displayName: Some metric has not been imported for 30 minutes.
- conditionAbsent:
    duration: 1800s
    filter: metric.type="custom.googleapis.com/opencensus/ts_bridge/oldest_metric_age"
      AND resource.type="global"
    aggregations:
    - alignmentPeriod: 60s
      perSeriesAligner: ALIGN_MAX
      crossSeriesReducer: REDUCE_MAX
      groupByFields: ["resource.label.project_id"]
    trigger:
      count: 1
  displayName: No metrics reported by ts-bridge for 30 minutes.
displayName: Time Series Bridge Stalled
documentation:
  content: |-
    This alerting policy triggers if one of the following is true:

    * one of the metrics configured in Time Series Bridge has not been updated for 30 minutes. This usually means that a given query is misconfigured or no longer returns any results.
    * an internal metric generated by Time Series Bridge has not been updated for 30 minutes. The most common cause for this is a bug in Time Series Bridge code or configuration.

    A good way to start troubleshooting would be to examine ts-bridge status page (if it's enabled) and logs.
  mimeType: text/markdown
enabled: true
